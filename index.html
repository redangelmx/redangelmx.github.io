<!DOCTYPE html>
<html lang="en">

<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <meta http-equiv="X-UA-Compatible" content="ie=edge">
  <title>Online Video Thumbnail Generator</title>
  <meta name="description" content="Generate Thumbnail">
  <style>
    :root {
      --primary-color: #6366f1;
      --primary-hover: #4f46e5;
      --primary-light: #818cf8;
      --primary-glow: rgba(99, 102, 241, 0.5);
      --neon-glow: rgba(99, 102, 241, 0.8);
      --neon-shadow: 0 0 8px rgba(99, 102, 241, 0.6), 0 0 16px rgba(99, 102, 241, 0.4);
      --text-color: #e5e7eb;
      --text-light: #9ca3af;
      --bg-color: #111827;
      --card-bg: #1f2937;
      --border-color: #374151;
      --shadow: 0 4px 6px -1px rgba(0, 0, 0, 0.5), 0 2px 4px -1px rgba(0, 0, 0, 0.4);
      --radius: 12px;
      --transition: all 0.3s ease;
    }

    * { box-sizing: border-box; margin: 0; padding: 0; }

    body {
      font-family: 'Inter', system-ui, -apple-system, 'Segoe UI', Roboto, 'Helvetica Neue', Arial;
      background-color: var(--bg-color);
      color: var(--text-color);
      line-height: 1.6;
      margin: 0;
    }

    header { background: #1a2435; box-shadow: var(--shadow), var(--neon-shadow); position: sticky; top: 0; z-index: 100; border-bottom: 1px solid var(--border-color); }
    .header-container { display:flex; justify-content:space-between; align-items:center; padding:16px 24px; max-width:1400px; margin:0 auto; width:100%; }
    .logo { font-size:1.2rem; font-weight:700; color:var(--primary-color); display:flex; align-items:center; gap:8px; }
    .actions { display:flex; gap:12px; }
    .btn { padding:8px 16px; border-radius:8px; font-weight:500; font-size:.95rem; cursor:pointer; transition:var(--transition); display:inline-flex; align-items:center; gap:6px; border:none; }
    .btn-text { background:transparent; color:var(--text-color); }
    .btn-primary { background:var(--primary-color); color:white; }
    .btn-outline { background:transparent; border:1px solid var(--border-color); color:var(--text-color); }

    /* main full width */
    main { width:100%; margin:0 auto; padding:24px; display:flex; flex-direction:column; gap:24px; }

    .card { background:var(--card-bg); border-radius:var(--radius); box-shadow:var(--shadow), var(--neon-shadow); padding:24px; border:1px solid var(--border-color); transition:var(--transition); }
    .section-title { font-size:1.15rem; font-weight:600; margin-bottom:12px; }

    .video-container { position:relative; border-radius:8px; overflow:hidden; background:#000; box-shadow:var(--neon-shadow); max-width:100%; }
    video { width:100%; height:100%; display:block; object-fit:contain; background:#000; }
    canvas { border-radius:8px; background:#000; display:block; max-width:100%; }

    .content-grid { display:grid; grid-template-columns: 1fr 1fr; gap:24px; align-items:start; }
    .content-grid.stacked { grid-template-columns: 1fr; }

    .preview-center { display:flex; flex-direction:column; align-items:center; }

    .dimensions { display:flex; gap:12px; margin-top:12px; }
    .size-label { font-size:.85rem; color:var(--text-light); text-align:center; margin-top:4px; }

    .slider { width:100%; height:6px; border-radius:3px; background:rgba(55,65,81,0.7); -webkit-appearance:none; }
    .slider::-webkit-slider-thumb { appearance:none; width:16px; height:16px; border-radius:50%; background:white; border:2px solid var(--primary-color); }

    .controls-row { display:flex; gap:8px; justify-content:center; margin-top:8px; flex-wrap:wrap; }

    .control-btn { background: rgba(55,65,81,0.7); border: none; border-radius:8px; width:40px; height:40px; display:flex; align-items:center; justify-content:center; cursor:pointer; transition:var(--transition); color:var(--text-color); }
    .control-btn:hover { background:var(--primary-color); color:white; }

    .action-buttons { display:flex; gap:12px; margin-top:12px; }

    @media (max-width: 1024px) { .content-grid { grid-template-columns: 1fr; } }
  </style>
             <!-- Add Font Awesome CDN in your <head> -->
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.0/css/all.min.css">
</head>

<body>
  <header>
    <div class="header-container">
      <div class="logo"><span class="logo-icon">🎥</span><span>Video Thumbnail Generator</span></div>
      <div class="actions">
        <button class="btn btn-text" onclick="document.getElementById('videofile').click()">Upload Video</button>
        <a class="btn btn-outline" href="https://github.com/fraigo/online-video-thumbnail-generator" target="_blank">GitHub</a>
      </div>
    </div>
  </header>

  <main>
   <div class="card" id="sourceSettings" style="font-size:0.8rem; padding:8px;">
  <h2 class="section-title" style="margin:0 0 6px; font-size:1rem;">Source & Settings</h2>

  <!-- 1) source type -->
  <div style="display:flex; gap:8px; margin-bottom:6px; align-items:center;">
    <label style="display:flex; align-items:center; gap:3px;">
      <input type="radio" id="video_file" name="video_source" checked onchange="showInput('select-file')"> File
    </label>
    <label style="display:flex; align-items:center; gap:3px;">
      <input type="radio" id="video_url" name="video_source" onchange="showInput('select-url')"> URL
    </label>
  </div>

  <!-- 2) file input -->
  <div id="select-file" style="margin-bottom:4px;">
    <input type="file" id="videofile" accept=".mp4,.webm,.ogg" onchange="loadVideoFile()" 
      style="font-size:0.8rem; padding:4px;">
  </div>

  <!-- 3) url input -->
  <div id="select-url" style="display:none; margin-bottom:4px;">
    <div style="display:flex; gap:6px;">
      <input type="text" id="videourl" placeholder="https://" 
        style="flex:1; padding:4px; font-size:0.8rem; background:#374151; border:1px solid var(--border-color); color:var(--text-color);" 
        onkeypress="if(event.key==='Enter') loadVideoURL(this.value)">
      <button class="btn btn-primary" style="font-size:0.8rem; padding:3px 8px;"
        onclick="loadVideoURL(document.getElementById('videourl').value)">Load</button>
    </div>
  </div>

  <!-- 4) output + resize inline -->
  <div class="dimensions" style="display:flex; gap:8px; margin-top:4px;">
    <div style="flex:1;">
      <label for="outputWidth" style="display:block; margin-bottom:2px;">Width</label>
      <input type="number" id="outputWidth" value="720" min="100" onchange="updateOutputSize()" 
        style="width:100%; padding:4px; font-size:0.8rem; background:#374151; border:1px solid var(--border-color); color:var(--text-color);">
      <div class="size-label" style="text-align:right; font-size:0.7rem;">px</div>
    </div>

    <div style="flex:1;">
      <label for="resizeSlider" style="display:block; margin-bottom:2px;">Display</label>
      <input type="range" id="resizeSlider" min="10" max="100" value="80" 
        oninput="updateDisplaySize(this.value)" class="slider" style="width:100%;">
      <div class="size-label" style="text-align:right; font-size:0.7rem;"><span id="resizeValue">80</span>%</div>
    </div>
  </div>
</div>


    <!-- VIDEO + THUMBNAIL -->
    <div class="content-grid" id="contentGrid">
      <div class="card" id="videoCard">
        <h2 class="section-title">Video Preview</h2>
        <div class="preview-center">
          <div class="video-container" id="videoContainer" style="width:480px; height:270px;">
            <video id="video" controls></video>
          </div>

          <div class="controls-row" id="videoControls" style="display:none">
            <!-- start, back30, back5, back1, play, fwd1, fwd5, fwd30, end -->



  <button class="control-btn" title="Back 30s" onclick="stepTime(-30)">
    <i class="fa-solid fa-backward"></i> 30s
  </button>
  <button class="control-btn" title="Back 5s" onclick="stepTime(-5)">
    <i class="fa-solid fa-backward-step"></i> 5s
  </button>
  <button class="control-btn" title="Back 1s" onclick="stepTime(-1)">
    <i class="fa-solid fa-caret-left"></i> 1s
  </button>

  <button class="control-btn" id="playPauseBtn" title="Play/Pause" onclick="togglePlayPause()">
    <i class="fa-solid fa-play"></i>
  </button>

  <button class="control-btn" title="Forward 1s" onclick="stepTime(1)">
    1s <i class="fa-solid fa-caret-right"></i>
  </button>
  <button class="control-btn" title="Forward 5s" onclick="stepTime(5)">
    5s <i class="fa-solid fa-forward-step"></i>
  </button>
  <button class="control-btn" title="Forward 30s" onclick="stepTime(30)">
    30s <i class="fa-solid fa-forward"></i>
  </button>


            <input type="range" id="slider" class="slider" style="width:100%; max-width:420px;" oninput="seekTo(this.value)" onmouseover="this.title=Math.floor(this.value)+'s'">
          </div>

          <div id="videoInfo" class="info-text" style="display:none; margin-top:8px;">Duration: <span id="duration">00:00</span></div>
        </div>
      </div>

      <div class="card" id="thumbCard">
        <h2 class="section-title">Thumbnail</h2>
        <div class="preview-center">
          <canvas id="canvas" style="width:480px; height:270px;"></canvas>

          <div class="action-buttons">
            <button id="snap" class="btn btn-primary" onclick="snapPicture()" disabled>Capture Frame</button>
            <button id="save" class="btn btn-outline" onclick="savePicture()" disabled>Save Image</button>
          </div>

          <div id="snapsize" class="info-text" style="margin-top:12px;"></div>
          <div class="image-link" id="imagelink" style="margin-top:8px;"></div>
        </div>
      </div>
    </div>

  </main>

  <script>
    let originalVideoWidth = 0, originalVideoHeight = 0, lastFullImage = null;
    let outputWidth = 720, displayScale = 1.0;
    let aspectRatio = 9/16; // height/width
    let currentVideoName = 'thumbnail';

    function showInput(id){ document.getElementById('select-file').style.display='none'; document.getElementById('select-url').style.display='none'; document.getElementById(id).style.display='block'; }

    function updateSliderTrack(){ const s = document.getElementById('slider'); if(!s || !s.max) return; const p = (s.value / s.max)*100; s.style.background = `linear-gradient(to right, var(--primary-color) ${p}%, rgba(55,65,81,0.7) ${p}%)`; }

    function initVideoControls(){ const video = document.getElementById('video'); if(!video) return; video.addEventListener('loadedmetadata', ()=>{
      document.getElementById('videoControls').style.display='flex'; document.getElementById('videoInfo').style.display='block'; document.getElementById('duration').textContent = formatTime(video.duration);
      updateSliderMax();
      originalVideoWidth = video.videoWidth || outputWidth; originalVideoHeight = video.videoHeight || Math.floor(outputWidth * aspectRatio);
      aspectRatio = originalVideoHeight / (originalVideoWidth || outputWidth);
      updateOutputSize();
    });
    video.addEventListener('timeupdate', ()=>{ const s=document.getElementById('slider'); if(s) s.value = video.currentTime; updateSliderTrack(); updatePlayPauseIcon(); });
    }

    function updateSliderMax(){ const video=document.getElementById('video'), s=document.getElementById('slider'); if(video && video.duration && s) s.max = video.duration; }
    function formatTime(sec){ const m=Math.floor(sec/60), s=Math.floor(sec%60); return `${String(m).padStart(2,'0')}:${String(s).padStart(2,'0')}`; }

    function updateOutputSize(){ outputWidth = parseInt(document.getElementById('outputWidth').value)||720; const canvas = document.getElementById('canvas'); if(!canvas) return; const outputHeight = Math.floor(outputWidth * aspectRatio); canvas.width = outputWidth; canvas.height = outputHeight;
      if(lastFullImage){ const ctx=canvas.getContext('2d'); const img=new Image(); img.onload = ()=>{ ctx.clearRect(0,0,outputWidth,outputHeight); ctx.drawImage(img,0,0,outputWidth,outputHeight); document.getElementById('snapsize').textContent = `Size: ${outputWidth} × ${outputHeight} pixels`; }; img.src = lastFullImage; }
      else document.getElementById('snapsize').textContent = `Size: ${outputWidth} × ${outputHeight} pixels`;
      // update displayed sizes
      updateDisplaySize(); }

    function updateDisplaySize(value){ if(value!==undefined && value!==null){ displayScale = (Number(value)||100)/100; document.getElementById('resizeValue') && (document.getElementById('resizeValue').textContent = Math.round(displayScale*100)); }
      const canvas = document.getElementById('canvas'); if(!canvas) return; const grid = document.getElementById('contentGrid'); const videoContainer = document.getElementById('videoContainer');
      const pixelH = canvas.height || Math.floor(outputWidth * aspectRatio);
      const fullDispW = Math.floor(outputWidth * displayScale);
      const fullDispH = Math.floor(pixelH * displayScale);

      // compute available width per column (accounting for gap and some padding)
      const gap = parseInt(getComputedStyle(grid).gap) || 24;
      const gridWidth = grid.clientWidth || (document.documentElement.clientWidth - 48);
      const availablePerColumn = Math.floor((gridWidth - gap) / 2);

      if(fullDispW > availablePerColumn){
        // stack cards into one column so big preview fits
        grid.classList.add('stacked');
        // use up to grid width minus some padding
        const maxW = gridWidth - 48; // leave small margins
        const useW = Math.min(fullDispW, maxW);
        const useH = Math.floor(useW * (pixelH / canvas.width));
        videoContainer.style.width = `${useW}px`;
        videoContainer.style.height = `${useH}px`;
        canvas.style.width = `${useW}px`;
        canvas.style.height = `${useH}px`;
      } else {
        // two column layout
        grid.classList.remove('stacked');
        videoContainer.style.width = `${fullDispW}px`;
        videoContainer.style.height = `${fullDispH}px`;
        canvas.style.width = `${fullDispW}px`;
        canvas.style.height = `${fullDispH}px`;
      }
    }

    // wire initialization
    document.addEventListener('DOMContentLoaded', ()=>{ updateSliderTrack(); updateOutputSize(); updateDisplaySize(100); initVideoControls(); const s = document.getElementById('slider'); if(s) s.addEventListener('input', updateSliderTrack); const rs = document.getElementById('resizeSlider'); if(rs) rs.addEventListener('input', (e)=> updateDisplaySize(e.target.value)); window.addEventListener('resize', ()=> updateDisplaySize()); });

    function goToTime(videoEl, time){ const video = document.getElementById('video'); if(!video) return; if(time === 'end'){ video.currentTime = video.duration || video.currentTime; return; } if(typeof time === 'number'){ // absolute seek
      const t = Math.max(0, Math.min(time, video.duration || time)); video.currentTime = t; }
    }

    function stepTime(delta){ const video = document.getElementById('video'); if(!video) return; const next = (video.currentTime || 0) + Number(delta || 0); video.currentTime = Math.max(0, Math.min(next, video.duration || next)); }

    function seekTo(value){ const video = document.getElementById('video'); if(!video) return; video.currentTime = Number(value); }

    function togglePlayPause(){ const video = document.getElementById('video'); const btn = document.getElementById('playPauseBtn'); if(!video) return; if(video.paused){ video.play(); btn.textContent = '⏸'; } else { video.pause(); btn.textContent = '▶️'; } }

    function updatePlayPauseIcon(){ const video = document.getElementById('video'); const btn = document.getElementById('playPauseBtn'); if(!video || !btn) return; btn.textContent = video.paused ? '▶️' : '⏸'; }

    // derive a friendly name for the video to use as thumbnail filename
    function setCurrentVideoNameFromFile(file){ if(!file) return; const name = file.name || 'thumbnail'; currentVideoName = name.replace(/\.[^/.]+$/, ''); document.getElementById('imagelink').textContent = `Filename: ${currentVideoName}.png`; }
    function setCurrentVideoNameFromURL(url){ try{ const u = new URL(url); let last = u.pathname.split('/').pop() || ''; last = last.split('?')[0].split('#')[0]; if(last){ currentVideoName = last.replace(/\.[^/.]+$/, ''); } else { currentVideoName = 'thumbnail'; } document.getElementById('imagelink').textContent = `Filename: ${currentVideoName}.png`; } catch(e){ currentVideoName = 'thumbnail'; document.getElementById('imagelink').textContent = '';} }

    function loadVideoFile(){ const fileInput = document.getElementById('videofile'); const file = fileInput.files[0]; if(!file) return; const video = document.getElementById('video'); const videoURL = URL.createObjectURL(file); video.src = videoURL; video.load(); document.getElementById('snap').disabled = false; setCurrentVideoNameFromFile(file); }

    function loadVideoURL(url){ if(!url) return; const video = document.getElementById('video'); video.src = url; video.load(); document.getElementById('snap').disabled = false; setCurrentVideoNameFromURL(url); }

    function snapPicture(){ const video = document.getElementById('video'); const canvas = document.getElementById('canvas'); if(!video || !canvas) return; const ctx = canvas.getContext('2d'); const drawW = canvas.width || outputWidth; const drawH = canvas.height || Math.floor(drawW * aspectRatio);
      try{ ctx.drawImage(video, 0, 0, drawW, drawH); }catch(e){ console.warn('Could not draw video frame:', e); }
      lastFullImage = canvas.toDataURL('image/png'); document.getElementById('save').disabled = false; document.getElementById('snapsize').textContent = `Size: ${canvas.width} × ${canvas.height} pixels`; }

    function savePicture(){ const canvas = document.getElementById('canvas'); if(!canvas) return; const image = canvas.toDataURL('image/png'); const link = document.createElement('a'); const name = (currentVideoName || 'thumbnail') + '.png'; link.download = name; link.href = image; link.click(); }
  </script>
</body>

</html>
